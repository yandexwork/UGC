# Исследование по выбору хранилища: MongoDb vs Postgres
 
### Настройка
 1) Скопировать файл env.example в env
 2) Указать свои данные
 3) Установить необходимые зависимости:
 ```pip install -r requirements.txt```
 4) Запустить контейнеры с монго и postgres:
 ```make up```

### Генерация данных:
 1) postgres: ```python3 pg_generate.py```
 2) mongodb: ```python3 mongo_generate.py```

### Запуск тестов:
 1) postgres: ```python3 pg_check.py```
 2) mongodb: ```python3 mongo_check.py```

### Объем данных
Исследование проводилось на 10 000 000 записей.<br>
Каждый тест проводился 10 раз. В Таблице ниже представлены усредненные значения.

## Результаты:

### Запись данных

###  Postgres:
| Запрос              | Среднее время, сек |
|---------------------|--------------------|
| insert to ratings   | 0.122675           |
| insert to reviews   | 0.110999           |
| insert to bookmarks | 0.052993           |

###  MongoDb:
| Запрос              | Среднее время, сек |
|---------------------|--------------------|
| insert to ratings   | 0.054062           |
| insert to reviews   | 0.012423           |
| insert to bookmarks | 0.015099           |


### Чтение данных

###  Postgres:
| Запрос             | Среднее время, сек |
|--------------------|--------------------|
| count likes        | 0.093117           |
| calc avg rating    | 0.083230           |
| get user bookmarks | 0.000458           |

###  MongoDb:
| Запрос              | Среднее время, сек |
|---------------------|--------------------|
| count likes         | 0.005531           |
| calc avg rating     | 0.002622           |
| get user bookmarks  | 0.001707           |


### Выводы
По результатам проведенных исследований оба хранилища укладываются в требуемое время к обработке данных: 200 мс (0,2 сек).
Тем не менее MongoDB показывает более высокую скорость работы на операциях вставки и чтения данных.
Так же не стоит забывать про возможность масштабируемости хранилища в будущем. 
С этой точки зрения выбор в пользу MongoDB очевиден, так как эта система больше подходит для масштабирования (проще, гибкая настройка).
В итоге нами сделан выбор использования в качестве хранилища MongoDB.
